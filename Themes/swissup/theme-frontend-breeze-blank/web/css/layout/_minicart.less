.minicart-wrapper {
    .mage-dropdown-dialog {
        &:extend(.breeze-dropdown all);
        &[style=""],
        &[style*="block"] {
            &:extend(.breeze-dropdown-visible);
        }
    }
    .action.showcart::before {
        .breeze-icon(@icon-shopping-bag);
    }
}

& when (@critical) {
    .minicart-wrapper {
        position: relative;
        .action.showcart {
            position: relative;
            .padding-right(@4);
            display: flex;
            align-items: center;

            &::before {
                content: '';
                display: block;
                width: @6;
                height: @6;
            }

            .text {
                &:extend(.sr-only);
            }

            .counter.qty {
                position: absolute;
                .right(0);
                min-width: @5;
                height: @5;
                text-align: center;
                display: flex;
                justify-content: center;
                align-items: center;
                &:extend(.text-xs);

                &.empty {
                    display: none;
                }

                &:not(.empty) {
                    .counter-number:not(:last-child) {
                        display: none;
                    }
                }

                .counter-label span {
                    &:extend(.sr-only);
                }
            }
        }
    }
}

& when not (@critical) {
    .minicart-wrapper {
        .mage-dropdown-dialog {
            width: @80;
            max-width: 90vw;
            display: block !important;
            padding: @3 @4;
            .right(@1);
            .modrtl(transform-origin, top right, top left);
        }
        .showcart {
            --spinner-size: @4;
        }
    }

    .block-minicart {
        .block-title {
            .float(left);
            padding: 0;
            border: 0;
            .qty {
                display: none;
            }
        }
        .block-content {
            clear: both;
            display: flex;
            flex-direction: column;
        }
        .action.close {
            &:extend(.button-x all);
            position: absolute;
            top: @2-5;
            .right(@2-5);
        }
        .items-total {
            &:extend(.text-lg);
            font-weight: 500;
            display: none;
        }
        .subtitle {
            display: none;
            &.empty {
                padding: @2 0 0;
                display: flex;
            }
        }
        .subtotal {
            display: flex;
            justify-content: space-between;
            margin: @2 0;
            font-weight: 500;
        }
        .block-content > .actions {
            margin: @1 0;
            text-align: center;

            .action.checkout {
                width: 100%;
                font-weight: 500;
                padding: @2-5;
                ~ div:not(:empty) {
                    margin-top: @2;
                    display: flex;
                    gap: @2;
                }
            }

            a.action {
                &:extend(.link-common all);
            }
        }
    }

    .minicart-items-wrapper {
        position: relative;
        height: auto !important;
        max-height: none !important;
        margin: @4 0;
        > .minicart-items {
            &:extend(.breeze-scrollbar all);
            max-height: 35vh;
            height: 100%;
            overflow: auto;
            overscroll-behavior: contain;
            padding: 0 @1 @1-5;
            .margin(0 0 0 -@1);

            .modal-slide[data-type="slide"] & {
                max-height: none;
            }
        }
        .message {
            margin-top: @1;
        }
        &::after {
            &:extend(.gradient-overflow);
        }
    }

    .minicart-items {
        li.product-item + li {
            margin-top: @4;
            padding-top: @4;
            border-top: 1px solid @divider__color;
        }
        li.product-item > div.product {
            position: relative;
            display: flex;
            flex-wrap: wrap;
            align-items: flex-start;
            gap: @3;

            > :nth-child(1) {
                max-width: 30%;
            }
            > :nth-child(2) {
                max-width: ~"calc(70% - @{3})";
                flex-grow: 1;
            }
            .message {
                width: 100%;
                &:last-child {
                    margin: 0;
                }
            }
        }

        .product-image-container {
            display: block;
            border: 1px solid @divider__color;
        }
        .product-item-photo,
        .product-image-container {
            flex-shrink: 0;
        }
        .subtotal,
        .price-container {
            margin: @1 0;
        }
        .details-qty {
            color: @muted__color;
            margin: @1 0;
            display: flex;
            align-items: center;
            gap: @1-5;

            .label,
            .value {
                &:extend(.text-sm);
            }
            .item-qty {
                &:extend(.input-xs);
                color: @muted__color;
                width: @10;
                border-color: transparent;
                .margin-left(-@1);
            }
            .update-cart-item {
                &:extend(.breeze-button-xs);
                span {
                    &:extend(.sr-only);
                }
                &::before {
                    content: '';
                    display: block;
                    width: @4;
                    height: @4;
                    .breeze-icon(@icon-check, @4);
                }
            }
        }
        .actions {
            display: flex;
            gap: @0-5;
            position: absolute;
            bottom: @2;
            .right(0);
            a {
                display: flex;
                --muted-alpha: .2;
                color: @muted__color;
            }
        }
        .action.edit,
        .action.delete {
            span {
                &:extend(.sr-only);
            }
            &::before {
                content: '';
                display: block;
                width: @6;
                height: @6;
            }
        }
        .action.edit::before {
            .breeze-icon(@icon-pencil, @5);
        }
        .action.delete::before {
            .breeze-icon(@icon-trash, @5);
        }
    }
}

& when not (@critical) {
    .minicart-items {
        .actions {
            a {
                &:extend(.transition);
            }
            a:hover {
                --muted-alpha: .4;
            }
        }
    }
}
